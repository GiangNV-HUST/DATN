<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlantUML Diagrams - Stock Trading System (MCP)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.2em;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            text-align: center;
            min-width: 150px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
        }

        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .diagram-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .diagram-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .diagram-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .diagram-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .diagram-card .use-case {
            color: #666;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .diagram-card .complexity {
            display: inline-block;
            background: #ffd700;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            margin-bottom: 15px;
        }

        .diagram-card .description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .diagram-card .participants {
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .diagram-card .participants-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .diagram-card .participants-list {
            color: #666;
            font-size: 0.85em;
            line-height: 1.5;
        }

        .diagram-card .actions {
            display: flex;
            gap: 10px;
        }

        .diagram-card button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-view {
            background: #667eea;
            color: white;
        }

        .btn-view:hover {
            background: #5568d3;
        }

        .btn-download {
            background: #28a745;
            color: white;
        }

        .btn-download:hover {
            background: #218838;
        }

        .instructions {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin-top: 40px;
            border-radius: 8px;
        }

        .instructions h2 {
            color: #856404;
            margin-bottom: 15px;
        }

        .instructions ol {
            margin-left: 20px;
            color: #856404;
        }

        .instructions li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .instructions code {
            background: #f8f9fa;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }

        .legend {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin-top: 30px;
            border-radius: 8px;
        }

        .legend h3 {
            color: #1976D2;
            margin-bottom: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            color: #333;
        }

        .legend-item .emoji {
            font-size: 1.5em;
            margin-right: 10px;
            width: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä PlantUML Diagrams</h1>
        <p class="subtitle">H·ªá th·ªëng giao d·ªãch ch·ª©ng kho√°n v·ªõi MCP Integration</p>

        <div class="stats">
            <div class="stat-card">
                <div class="number">9</div>
                <div class="label">Diagrams</div>
            </div>
            <div class="stat-card">
                <div class="number">25</div>
                <div class="label">MCP Tools</div>
            </div>
            <div class="stat-card">
                <div class="number">7-9</div>
                <div class="label">Participants/Diagram</div>
            </div>
        </div>

        <div class="diagram-grid">
            <!-- Use Case Diagram -->
            <div class="diagram-card">
                <h3>üìã Use Case Diagram</h3>
                <div class="use-case">S∆° ƒë·ªì t·ªïng quan h·ªá th·ªëng</div>
                <div class="complexity">‚≠ê‚≠ê Medium</div>
                <div class="description">
                    Hi·ªÉn th·ªã 9 use cases ch√≠nh v√† m·ªëi quan h·ªá v·ªõi MCP Server.
                    Th·ªÉ hi·ªán r√µ lu·ªìng t·ª´ User ‚Üí Use Cases ‚Üí MCP ‚Üí External Services.
                </div>
                <div class="participants">
                    <div class="participants-title">Components:</div>
                    <div class="participants-list">
                        User, 9 Use Cases, MCP Server, Database, TCBS API, Gemini AI
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('usecase_diagram_with_mcp.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC1 -->
            <div class="diagram-card">
                <h3>üîê UC1: X√°c th·ª±c danh t√≠nh</h3>
                <div class="use-case">Authentication Flow</div>
                <div class="complexity">‚≠ê Simple</div>
                <div class="description">
                    User g·ª≠i tin nh·∫Øn ‚Üí Bot ki·ªÉm tra session ‚Üí MCP tool get_user_session
                    ‚Üí Validate v√† return k·∫øt qu·∫£. C√≥ caching 5 ph√∫t.
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (7):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, MCP Wrapper, MCP Client, MCP Server, Database
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc1_xac_thuc.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC2 -->
            <div class="diagram-card">
                <h3>üîî UC2: ƒêƒÉng k√Ω c·∫£nh b√°o</h3>
                <div class="use-case">Alert Management</div>
                <div class="complexity">‚≠ê‚≠ê Medium</div>
                <div class="description">
                    AI Router ph√¢n t√≠ch c√¢u h·ªèi ‚Üí AlertManager extract th√¥ng tin
                    ‚Üí MCP tool create_alert ‚Üí Insert v√†o database. Kh√¥ng cache v√¨ l√† write operation.
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (8):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, Alert Agent, MCP Wrapper, MCP Client, MCP Server, Database
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc2_dang_ky_canh_bao.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC3 -->
            <div class="diagram-card">
                <h3>üìå UC3: ƒêƒÉng k√Ω theo d√µi</h3>
                <div class="use-case">Subscription Management</div>
                <div class="complexity">‚≠ê‚≠ê Medium</div>
                <div class="description">
                    User subscribe m√£ c·ªï phi·∫øu ‚Üí SubscriptionManager
                    ‚Üí MCP tool create_subscription ‚Üí Th√™m v√†o monitoring queue.
                    Background worker s·∫Ω check gi√°, tin t·ª©c ƒë·ªãnh k·ª≥.
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (8):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, Subscription Manager, MCP Wrapper, MCP Client, MCP Server, Database
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc3_subscription.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC4 -->
            <div class="diagram-card">
                <h3>üîç UC4: L·ªçc c·ªï phi·∫øu</h3>
                <div class="use-case">Stock Screening</div>
                <div class="complexity">‚≠ê‚≠ê‚≠ê Complex</div>
                <div class="description">
                    Screener v·ªõi 80+ criteria. G·ªçi TCBS API ‚Üí L·∫•y fundamental data,
                    query Database ‚Üí L·∫•y technical indicators, merge data trong MCP Server.
                    Cache 10 ph√∫t ‚Üí L·∫ßn sau nhanh 10x.
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (9):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, Screener Agent, MCP Wrapper, MCP Client, MCP Server, TCBS API, Database
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc4_loc_co_phieu.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC6 -->
            <div class="diagram-card">
                <h3>üìà UC6: Ph√¢n t√≠ch KT & TC</h3>
                <div class="use-case">Technical & Fundamental Analysis</div>
                <div class="complexity">‚≠ê‚≠ê‚≠ê‚≠ê Very Complex</div>
                <div class="description">
                    Orchestrate 4 MCP tools: get_stock_data ‚Üí get_financial_data
                    ‚Üí generate_chart ‚Üí gemini_summarize. Gemini AI t√¨m ki·∫øm web,
                    ph√¢n t√≠ch sentiment, ƒë∆∞a ra khuy·∫øn ngh·ªã. Total ~2s l·∫ßn ƒë·∫ßu, <500ms khi cached.
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (9):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, Analysis Agent, MCP Wrapper, MCP Client, MCP Server, Gemini AI, Database
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc6_phan_tich.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC7 -->
            <div class="diagram-card">
                <h3>üìä UC7: Xem bi·ªÉu ƒë·ªì</h3>
                <div class="use-case">Chart Generation</div>
                <div class="complexity">‚≠ê‚≠ê Medium</div>
                <div class="description">
                    L·∫•y price history t·ª´ MCP ‚Üí Discord Bot t·∫°o chart local b·∫±ng matplotlib.
                    4 subplots: Candlestick + MA, Volume, RSI, MACD.
                    Option: C√≥ th·ªÉ d√πng MCP tool generate_chart_from_data (centralized).
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (7):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, Analysis Agent, MCP Wrapper, MCP Client, MCP Server, Database
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc7_chart.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC8 -->
            <div class="diagram-card" style="grid-column: span 2;">
                <h3>üíº UC8: T∆∞ v·∫•n ƒë·∫ßu t∆∞</h3>
                <div class="use-case">Investment Advisory - Most Complex</div>
                <div class="complexity">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Most Complex</div>
                <div class="description">
                    <strong>Orchestrate 6 MCP tools tu·∫ßn t·ª±:</strong><br>
                    1. gather_investment_profile ‚Üí Thu th·∫≠p profile ƒë·∫ßu t∆∞<br>
                    2. discover_stocks_by_profile ‚Üí T√¨m 10 c·ªï phi·∫øu ph√π h·ª£p<br>
                    3. calculate_portfolio_allocation ‚Üí Ph√¢n b·ªï danh m·ª•c 100M VNƒê<br>
                    4. generate_entry_strategy ‚Üí Chi·∫øn l∆∞·ª£c DCA 4 tu·∫ßn<br>
                    5. generate_risk_management_plan ‚Üí Stop loss, take profit<br>
                    6. generate_monitoring_plan ‚Üí K·∫ø ho·∫°ch theo d√µi h√†ng ng√†y<br>
                    <br>
                    Gemini AI ƒë∆∞·ª£c g·ªçi 3 l·∫ßn. Total: ~15-20s l·∫ßn ƒë·∫ßu, <2s khi cached.
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (9):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, Investment Planner, MCP Wrapper, MCP Client, MCP Server, Gemini AI, Database/TCBS
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc8_tu_van_dau_tu.puml')">Xem File</button>
                </div>
            </div>

            <!-- UC9 -->
            <div class="diagram-card">
                <h3>üîé UC9: Kh√°m ph√° c·ªï phi·∫øu</h3>
                <div class="use-case">Stock Discovery</div>
                <div class="complexity">‚≠ê‚≠ê‚≠ê Complex</div>
                <div class="description">
                    Natural language search v·ªõi 3 MCP tools: search_potential_stocks
                    ‚Üí filter_stocks_by_criteria ‚Üí rank_stocks_by_score.
                    AI-powered ranking (Technical 30% + Fundamental 40% + Sentiment 30%).
                    Gemini t√¨m ki·∫øm tin t·ª©c, ph√¢n t√≠ch sentiment.
                </div>
                <div class="participants">
                    <div class="participants-title">Participants (9):</div>
                    <div class="participants-list">
                        User, Bot, Root Agent, Discovery Specialist, MCP Wrapper, MCP Client, MCP Server, Gemini AI, Database/TCBS
                    </div>
                </div>
                <div class="actions">
                    <button class="btn-view" onclick="openFile('sequence_uc9_discovery.puml')">Xem File</button>
                </div>
            </div>
        </div>

        <div class="legend">
            <h3>üìñ Legend - Participants trong Diagrams</h3>
            <div class="legend-item">
                <span class="emoji">üë§</span>
                <span><strong>User:</strong> Ng∆∞·ªùi d√πng th√¥ng qua Discord</span>
            </div>
            <div class="legend-item">
                <span class="emoji">ü§ñ</span>
                <span><strong>Discord Bot:</strong> Interface layer, format messages, generate charts</span>
            </div>
            <div class="legend-item">
                <span class="emoji">üéØ</span>
                <span><strong>Root Agent (HybridOrchestrator):</strong> AI Router, quy·∫øt ƒë·ªãnh mode & agent</span>
            </div>
            <div class="legend-item">
                <span class="emoji">‚öôÔ∏è</span>
                <span><strong>Specialized Agents (6):</strong> AlertManager, Screener, Analysis, Investment, Subscription, Discovery</span>
            </div>
            <div class="legend-item">
                <span class="emoji">üîó</span>
                <span><strong>MCP Wrapper:</strong> Bridge async ‚Üî sync contexts (ThreadPoolExecutor)</span>
            </div>
            <div class="legend-item">
                <span class="emoji">üíæ</span>
                <span><strong>MCP Client (Enhanced):</strong> Caching, retry, circuit breaker, metrics</span>
            </div>
            <div class="legend-item">
                <span class="emoji">üñ•Ô∏è</span>
                <span><strong>MCP Server:</strong> Process ri√™ng, 25 tools, k·∫øt n·ªëi Database/APIs</span>
            </div>
            <div class="legend-item">
                <span class="emoji">üóÑÔ∏è</span>
                <span><strong>Database:</strong> PostgreSQL + TimescaleDB (stock prices, ratios, alerts, subscriptions)</span>
            </div>
            <div class="legend-item">
                <span class="emoji">‚òÅÔ∏è</span>
                <span><strong>TCBS API:</strong> Vietnamese stock market data (80+ screening criteria)</span>
            </div>
            <div class="legend-item">
                <span class="emoji">ü§ñ</span>
                <span><strong>Gemini AI:</strong> Google's AI for analysis, search, sentiment, ranking</span>
            </div>
        </div>

        <div class="instructions">
            <h2>üöÄ C√°ch s·ª≠ d·ª•ng PlantUML trong VS Code</h2>
            <ol>
                <li>
                    <strong>C√†i extension PlantUML:</strong><br>
                    M·ªü VS Code ‚Üí Extensions (Ctrl+Shift+X) ‚Üí T√¨m "PlantUML" ‚Üí Install
                </li>
                <li>
                    <strong>Preview diagram:</strong><br>
                    M·ªü file <code>.puml</code> ‚Üí Nh·∫•n <code>Alt+D</code> ho·∫∑c <code>Ctrl+Shift+P</code> ‚Üí "PlantUML: Preview Current Diagram"
                </li>
                <li>
                    <strong>Export PNG/SVG:</strong><br>
                    <code>Ctrl+Shift+P</code> ‚Üí "PlantUML: Export Current Diagram" ‚Üí Ch·ªçn format (PNG/SVG/PDF)
                </li>
                <li>
                    <strong>Export t·∫•t c·∫£ c√πng l√∫c:</strong><br>
                    Ch·∫°y Python script: <code>python render_all.py</code><br>
                    Ho·∫∑c command line: <code>java -jar plantuml.jar -tpng *.puml</code>
                </li>
                <li>
                    <strong>Thay th·∫ø trong t√†i li·ªáu Word:</strong><br>
                    Copy file PNG t·ª´ th∆∞ m·ª•c <code>output/</code> ‚Üí Paste v√†o Word/PDF
                </li>
            </ol>
        </div>
    </div>

    <script>
        function openFile(filename) {
            alert('M·ªü file: ' + filename + '\n\nTrong VS Code:\n1. M·ªü file n√†y trong Explorer\n2. Nh·∫•n Alt+D ƒë·ªÉ preview\n3. Ctrl+Shift+P ‚Üí "PlantUML: Export" ƒë·ªÉ export PNG');
        }
    </script>
</body>
</html>