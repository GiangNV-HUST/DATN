!pragma charset UTF-8
@startuml agent_system_architecture
!theme plain
skinparam backgroundColor #FFFFFF
skinparam shadowing false
skinparam defaultFontName "Times New Roman"

title Multi-Agent System Architecture (8 Specialists)

skinparam rectangle {
    BackgroundColor<<user>> #E8E8FF
    BackgroundColor<<router>> #FFECB3
    BackgroundColor<<agent>> #FFD6D6
    BackgroundColor<<market>> #D4EDDA
    BackgroundColor<<output>> #F0E6FF
    BorderColor #333333
    FontSize 11
}

rectangle "User's Query" as query <<user>>
rectangle "Root Agent\n(AI-Powered Router)" as root <<router>>
rectangle "Output" as output <<output>>

' 8 Specialists
rectangle "AlertManager" as alert <<agent>>
rectangle "SubscriptionManager" as subscription <<agent>>
rectangle "ScreenerSpecialist" as screener <<agent>>
rectangle "AnalysisSpecialist" as analysis <<agent>>
rectangle "InvestmentPlanner" as investment <<agent>>
rectangle "DiscoverySpecialist" as discovery <<agent>>
rectangle "MarketContextSpecialist" as market <<market>>
rectangle "ComparisonSpecialist" as comparison <<market>>

query --> root : "AI Routing"

root --> alert : "Quản lý cảnh báo giá\n(tạo/xóa/danh sách)"
root --> subscription : "Quản lý đăng ký\n(tạo/xóa/danh sách)"
root --> screener : "Sàng lọc cổ phiếu\n(P/E, ROE, thanh khoản)"
root --> analysis : "Phân tích cổ phiếu\n(kỹ thuật, cơ bản, tin tức)"
root --> investment : "Lập kế hoạch đầu tư\n(DCA, phân bổ danh mục)"
root --> discovery : "Tìm cổ phiếu tiềm năng\n(khuyến nghị, dự báo)"
root --> market : "Tổng quan thị trường\n(VN-Index, ngành, breadth)"
root --> comparison : "So sánh cổ phiếu\n(2+ mã, ranking)"

alert --> output
subscription --> output
screener --> output
analysis --> output
investment --> output
discovery --> output
market --> output
comparison --> output

note right of root
  **Multi-Agent Workflow:**
  - Sequential: Agent1 → Agent2
  - Parallel: Agent1 || Agent2
  - Context passing between agents
end note

note bottom of market
  **New in v2.0:**
  - MarketContextSpecialist
  - ComparisonSpecialist
end note

@enduml
