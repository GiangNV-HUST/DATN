!pragma charset UTF-8
@startuml sequence_uc11_market_context
!theme plain
skinparam backgroundColor #FEFEFE
skinparam shadowing false
skinparam defaultFontName "Times New Roman"

title UC11: T·ªïng quan th·ªã tr∆∞·ªùng (Market Overview)

actor User
participant "Root Agent" as Root
participant "MarketContext Specialist" as Market
participant "Multi-Model System" as Models
participant "MCP Server" as MCP
database "PostgreSQL" as DB

== Initialization ==
User -> Root: "Th·ªã tr∆∞·ªùng h√¥m nay th·∫ø n√†o?"
activate Root
Root -> Market: Route to MarketContextSpecialist
activate Market

== Market Data Collection ==
Market -> MCP: Get market overview
activate MCP
MCP -> DB: Get market data:\n‚Ä¢ Top 100 by volume\n‚Ä¢ Gainers & losers\n‚Ä¢ Sector performance
activate DB
DB --> MCP: Market data
deactivate DB

MCP -> MCP: Calculate:\n‚Ä¢ Market breadth (advancing/declining)\n‚Ä¢ Volume trends\n‚Ä¢ Sector rotation
MCP --> Market: Market statistics
deactivate MCP

== Analysis ==
Market -> Models: Summarize market data\n(Gemini Flash)
activate Models
Models --> Market: Market summary
deactivate Models

Market -> Models: Deep market analysis\n(Claude Opus 4.5)
activate Models
Models -> Models: Analyze trends\nSector performance\nInvestment outlook
Models --> Market: Complete market analysis
deactivate Models

== Result ==
Market --> Root: Market overview report
deactivate Market
Root --> User: üìà T·ªïng quan th·ªã tr∆∞·ªùng:\n\n**Ch·ªâ s·ªë ch√≠nh:**\n‚Ä¢ VN-Index: 1,245 (+0.8%)\n‚Ä¢ VN30: 1,389 (+1.2%)\n‚Ä¢ HNX-Index: 234 (-0.3%)\n\n**Di·ªÖn bi·∫øn:**\n‚Ä¢ TƒÉng: 245 | Gi·∫£m: 183\n‚Ä¢ Thanh kho·∫£n: 18,500 t·ª∑ (+15%)\n\n**Top Gainers:**\n1. VCB: +3.5% | 2. HPG: +2.8%\n\n**Ph√¢n t√≠ch:**\nTh·ªã tr∆∞·ªùng t√≠ch c·ª±c, d√≤ng ti·ªÅn\nv√†o ng√¢n h√†ng & th√©p
deactivate Root

note over User, DB
  **Market Metrics:**
  ‚Ä¢ Index performance (VN-Index, VN30, HNX)
  ‚Ä¢ Market breadth (advancing/declining)
  ‚Ä¢ Trading volume & liquidity
  ‚Ä¢ Top movers (gainers/losers)
  ‚Ä¢ Sector rotation analysis

  **Multi-Model Usage:**
  ‚Ä¢ Gemini Flash: Fast market summarization
  ‚Ä¢ Claude Opus: Deep trend analysis
end note

@enduml
